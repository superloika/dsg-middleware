(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{17:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n);function i(e,t,a,n,r,i,o){try{var l=e[i](o),s=l.value}catch(e){return void a(e)}l.done?t(s):Promise.resolve(s).then(n,r)}function o(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function l(e){i(o,n,r,l,s,"next",e)}function s(e){i(o,n,r,l,s,"throw",e)}l(void 0)}))}}var l={components:{GeneratedTable:function(){return a.e(0).then(a.bind(null,19))}},data:function(){return{datePickerShown:!1,date:[new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10)],generatedData:[],isGenerating:!1,wrapperID:"gendata_history_wrapper",selectedFilter:null}},computed:{lineCount:function(){var e=0;return this.generatedData.forEach((function(t){e+=t[1].length})),e},dateRangeText:function(){return this.date.join(" ~ ")},myStore:function(){return this[this.PrincipalsStore.state.selectedPrincipalCode]}},methods:{generate:function(e){var t=arguments,a=this;return o(r.a.mark((function n(){var i,o,l,s;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.length>1&&void 0!==t[1]?t[1]:"",e.sort(),o=a.AppStore.state.siteUrl+"principals/"+"generated?date=".concat(e,"&table_generated=")+"generated_".concat(a.PrincipalsStore.state.selectedPrincipalCode),n.prev=3,a.AppStore.state.showTopLoading=!0,a.isGenerating=!0,a.generatedData=[],n.next=9,axios.get(o);case 9:l=n.sent,s=l.data.generated_data.reduce((function(e,t){return e[t[i]]=e[t[i]]||[],e[t[i]].push(t),e}),Object.create(null)),a.generatedData=Object.entries(s),a.isGenerating=!1,a.AppStore.state.showTopLoading=!1,a.dlgSelectDatesShown=!1,n.next=21;break;case 17:n.prev=17,n.t0=n.catch(3),console.log("generate(): ",n.t0),a.AppStore.toast(n.t0);case 21:case"end":return n.stop()}}),n,null,[[3,17]])})))()},exportToExcel:function(){var e=this.PrincipalsStore.getHeaderAndFormat("generatedDataTableHeader");this.PrincipalsStore.exportToExcel(e.header,this.PrincipalsStore.generatedDataSubset(this.generatedData,e.format),null,this.PrincipalsStore.state.selectedPrincipalCode)}},watch:{selectedFilter:function(e){this.generate(this.date,e)}},created:function(){this.selectedFilter=this.myStore.state.generatedDataHistoryFilters[0].value},mounted:function(){console.log("GeneratedHistory component mounted")}},s=a(0),c=Object(s.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"elevation-0 pt-2",attrs:{outlinedx:""}},[a("v-card-title",{staticClass:"pa-0"},[a("v-app-bar",{attrs:{elevation:"0",color:"white"}},[a("v-toolbar-title",[e._v("\n                Generated Data History\n                "),e.lineCount>0?a("div",[a("v-chip",{attrs:{"x-small":"",outlined:"",label:"",color:"primary"}},[e._v("\n                        "+e._s(e.lineCount)+" total line/s\n                    ")])],1):e._e()]),e._v(" "),a("v-spacer"),e._v(" "),a("v-text-field",{staticClass:"mr-3",staticStyle:{"max-width":"230px"},attrs:{label:"Date (YYYY-MM-DD)","hide-details":"",readonly:"",dense:"",outlined:"",rounded:"",disabled:e.isGenerating},on:{click:function(t){t.stopPropagation(),e.datePickerShown=!0}},model:{value:e.dateRangeText,callback:function(t){e.dateRangeText=t},expression:"dateRangeText"}}),e._v(" "),a("v-dialog",{ref:"datePicker",attrs:{"return-value":e.date,width:"290px"},on:{"update:returnValue":function(t){e.date=t},"update:return-value":function(t){e.date=t}},model:{value:e.datePickerShown,callback:function(t){e.datePickerShown=t},expression:"datePickerShown"}},[a("v-date-picker",{attrs:{scrollable:"",range:""},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}},[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.datePickerShown=!1}}},[e._v("\n                        Cancel\n                    ")]),e._v(" "),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.$refs.datePicker.save(e.date),e.generate(e.date,e.selectedFilter)}}},[e._v("\n                        Generate\n                    ")])],1)],1),e._v(" "),a("v-select",{staticClass:"mr-3",staticStyle:{"max-width":"215px"},attrs:{items:e.myStore.state.generatedDataHistoryFilters,label:"Group By","item-text":"text","item-value":"value",disabled:e.isGenerating,outlined:"",rounded:"","hide-details":"",dense:""},model:{value:e.selectedFilter,callback:function(t){e.selectedFilter=t},expression:"selectedFilter"}}),e._v(" "),a("v-btn",{attrs:{title:"Export to Excel",icon:"",dense:"",rounded:"",outlinedx:"",color:"success",disabled:e.generatedData.length<1},on:{click:function(t){return e.exportToExcel()}}},[a("v-icon",[e._v("mdi-file-excel")])],1)],1)],1),e._v(" "),a("v-card-text",{staticClass:"pa-0"},[e.generatedData.length<1?a("div",{staticClass:"d-flex justify-center mt-5"},[a("v-chip",{attrs:{color:"accent",small:""}},[e._v("\n                No available data to display\n            ")])],1):a("GeneratedTable",{attrs:{id:e.wrapperID,generatedData:e.generatedData}})],1)],1)}),[],!1,null,null,null);t.default=c.exports}}]);