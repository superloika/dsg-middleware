(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{16:function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r);function a(t,e,n,r,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function i(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var c={components:{GeneratedTableWrapper:function(){return n.e(0).then(n.bind(null,19))},InvoicesImport:function(){return n.e(10).then(n.bind(null,20))},UnknownCodes:function(){return n.e(15).then(n.bind(null,27))},Settings:function(){return n.e(3).then(n.bind(null,24))}},data:function(){return{searchKey:"",confirmExportDialogOpen:!1,isExporting:!1,wrapperID:"gendata_wrapper",dlgDistinctCustomerCodesNA:null,dlgDistinctProductCodesNA:null}},computed:{generatedData:function(){var t=this,e=this.PrincipalsStore.state.currentGeneratedData,n=new RegExp(this.searchKey,"i");return e.map((function(e){return[e[0],e[1].filter((function(e){return""==t.searchKey||null==t.searchKey||n.test(e.customer_code)||n.test(e.route_code)||n.test(e.order_no)||n.test(e.product_code)}))]}))},lineCount:function(){var t=0;return this.generatedData.forEach((function(e){t+=e[1].length})),t},productsNotFoundCount:function(){var t=0;return this.generatedData.forEach((function(e){var n=e[1].filter((function(t){return 1==t.product_notfound}));t+=n.length})),t},customersNotFoundCount:function(){var t=0;return this.generatedData.forEach((function(e){var n=e[1].filter((function(t){return 1==t.customer_notfound}));t+=n.length})),t},selectedPrincipalCode:function(){return this.PrincipalsStore.state.selectedPrincipalCode},distinctCustomerCodesNA:function(){try{var t=[];return this.PrincipalsStore.state.currentGeneratedData.forEach((function(e){var n,r=[];(e[1].forEach((function(t){1==t.customer_notfound&&r.push(t.customer_code)})),r.length>0)&&(n=t).push.apply(n,r)})),t=i(new Set(t))}catch(t){return console.log("distinctCustomerCodesNA() - ERR:",t),[]}},distinctProductCodesNA:function(){try{var t=[];return this.PrincipalsStore.state.currentGeneratedData.forEach((function(e){var n,r=[];(e[1].forEach((function(t){1==t.product_notfound&&r.push(t.product_code)})),r.length>0)&&(n=t).push.apply(n,r)})),t=i(new Set(t))}catch(t){return console.log("initDistinctProductCodesNA() - ERR:",t),[]}},searchKeyLength:function(){try{return this.searchKey.length}catch(t){return 0}},myStore:function(){return this[this.selectedPrincipalCode]}},methods:{saveInvoices:function(){var t,e=this;return(t=o.a.mark((function t(){var n,r,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.isExporting=!0,n=e.AppStore.state.siteUrl+"principals/"+e.selectedPrincipalCode+"/invoices/save",r={raw_invoices:e.PrincipalsStore.state.currentRawInvoices,generated_data:e.generatedData},t.next=6,axios.post(n,r);case 6:t.sent,a=e.PrincipalsStore.getHeaderAndFormat("generatedDataTableHeader"),e.PrincipalsStore.exportToExcel(a.header,e.PrincipalsStore.generatedDataSubset(e.generatedData,a.format),null,e.PrincipalsStore.state.selectedPrincipalCode),e.isExporting=!1,e.confirmExportDialogOpen=!1,e.PrincipalsStore.state.currentGeneratedData=[],e.PrincipalsStore.state.currentRawInvoices=[],e.myStore.state.currentGeneratedData=[],e.myStore.state.currentRawInvoices=[],e.PrincipalsStore.initInvoicesGrandTotal(),e.PrincipalsStore.initInvoices(e.selectedPrincipalCode,e.AppStore.state.strDateToday),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(0),console.log("saveInvoices():",t.t0);case 22:case"end":return t.stop()}}),t,null,[[0,19]])})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){a(i,r,o,s,c,"next",t)}function c(t){a(i,r,o,s,c,"throw",t)}s(void 0)}))})()}},created:function(){},mounted:function(){console.log("Generated component mounted")}},l=n(0),d=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pt-4"},[n("v-sheet",{staticClass:"px-3"},[n("InvoicesImport")],1),t._v(" "),n("v-card",{staticClass:"elevation-0",attrs:{color:""}},[n("v-card-title",{staticClass:"pa-0"},[n("v-app-bar",{attrs:{elevation:"0",color:"white"}},[n("v-toolbar-title",[t._v("\n                    Generated Data\n                    "),t.lineCount>0?n("div",[n("v-chip",{attrs:{"x-small":"",outlined:"",label:"",color:"primary"}},[t._v("\n                            "+t._s(t.lineCount)+" total line/s\n                        ")]),t._v(" "),t.customersNotFoundCount>0?n("v-chip",{attrs:{"x-small":"",outlined:"",label:"",color:"warning"}},[t._v("\n                            "+t._s(t.customersNotFoundCount)+" warning/s\n                        ")]):t._e(),t._v(" "),t.productsNotFoundCount>0?n("v-chip",{attrs:{"x-small":"",outlined:"",label:"",color:"error"}},[t._v("\n                            "+t._s(t.productsNotFoundCount)+" error/s\n                        ")]):t._e()],1):t._e()]),t._v(" "),n("v-spacer"),t._v(" "),n("v-text-field",{staticClass:"mr-3",staticStyle:{"max-width":"200px"},attrs:{label:"Search",title:"Search","hide-details":"",dense:"",flat:"",rounded:"",clearable:"","solo-inverted":"",disabled:t.PrincipalsStore.state.currentGeneratedData.length<1},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),t._v(" "),n("v-btn",{attrs:{title:"Unknown Customer Codes",icon:"",dense:"",rounded:"",outlinedx:"",depressed:"",color:"warning",disabled:t.distinctCustomerCodesNA.length<1},on:{click:function(e){e.stopPropagation(),t.dlgDistinctCustomerCodesNA=!0}}},[n("v-icon",[t._v("mdi-account-multiple")])],1),t._v(" "),n("v-dialog",{attrs:{persistentx:"","max-width":"520",scrollable:""},model:{value:t.dlgDistinctCustomerCodesNA,callback:function(e){t.dlgDistinctCustomerCodesNA=e},expression:"dlgDistinctCustomerCodesNA"}},[n("UnknownCodes",{attrs:{title:"Unknown Customer Codes",unknownCodes:t.distinctCustomerCodesNA,type:"warning",temptxt_id:"temptxt_customers"}})],1),t._v(" "),n("v-btn",{attrs:{title:"Unknown Product Codes",icon:"",dense:"",rounded:"",outlinedx:"",depressed:"",color:"error",disabled:t.distinctProductCodesNA.length<1},on:{click:function(e){e.stopPropagation(),t.dlgDistinctProductCodesNA=!0}}},[n("v-icon",[t._v("mdi-cube")])],1),t._v(" "),n("v-dialog",{attrs:{persistentx:"","max-width":"500",scrollable:""},model:{value:t.dlgDistinctProductCodesNA,callback:function(e){t.dlgDistinctProductCodesNA=e},expression:"dlgDistinctProductCodesNA"}},[n("UnknownCodes",{attrs:{title:"Unknown Product Codes",unknownCodes:t.distinctProductCodesNA,type:"error",temptxt_id:"temptxt_products"}})],1),t._v(" "),n("v-btn",{attrs:{title:"Save Data and Export to Excel",icon:"",dense:"",rounded:"",outlinedx:"",depressed:"",color:"success",disabled:t.lineCount<1||t.customersNotFoundCount>0||t.productsNotFoundCount>0||t.searchKeyLength>0},on:{click:function(e){e.stopPropagation(),t.confirmExportDialogOpen=!0}}},[n("v-icon",[t._v("mdi-content-save-all")])],1),t._v(" "),n("v-dialog",{attrs:{persistent:"","max-width":"320"},model:{value:t.confirmExportDialogOpen,callback:function(e){t.confirmExportDialogOpen=e},expression:"confirmExportDialogOpen"}},[n("v-card",[n("v-card-title",[t._v("Save and Export")]),t._v(" "),n("v-card-text",{staticClass:"text-subtitle-1"},[t._v("\n                            Save generated data to the database and export to Excel?\n                        ")]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"primary",loading:t.isExporting,text:""},on:{click:function(e){return t.saveInvoices()}}},[t._v("\n                                Proceed\n                            ")]),t._v(" "),n("v-btn",{attrs:{disabled:t.isExporting,text:""},on:{click:function(e){t.confirmExportDialogOpen=!1}}},[t._v("\n                                Cancel\n                            ")])],1)],1)],1)],1)],1),t._v(" "),n("v-card-text",{staticClass:"mx-0 px-0"},[n("div",{},[t.generatedData.length<1?n("div",{staticClass:"d-flex justify-center mt-3"},[n("v-chip",{attrs:{color:"accent",small:""}},[t._v("\n                        No available data to display\n                    ")])],1):n("GeneratedTableWrapper",{attrs:{id:t.wrapperID,generatedData:t.generatedData}})],1)])],1)],1)}),[],!1,null,"6bf13d9a",null);e.default=d.exports}}]);