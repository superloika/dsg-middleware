{"version":3,"sources":["webpack:///resources/js/pages/ManageAccounts/AccountsEditDesignatedPrincipal.vue","webpack:///./resources/js/pages/ManageAccounts/AccountsEditDesignatedPrincipal.vue?81b6","webpack:///./resources/js/pages/ManageAccounts/AccountsEditDesignatedPrincipal.vue","webpack:///./resources/js/pages/ManageAccounts/AccountsEditDesignatedPrincipal.vue?8b37","webpack:///./resources/js/pages/ManageAccounts/AccountsEditDesignatedPrincipal.vue?1e6d"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA;AACA,MADA,kBACA;AACA;AACA,+BADA;AAEA;AACA,+CADA;AAEA,6DAFA;AAGA;AAHA,OAFA;AAOA,8BAPA;AAQA,iBARA;AASA,yBATA;AAUA,mBAVA;AAWA,6BAXA;AAYA;AAZA;AAcA,GAhBA;AAkBA;AACA;AACA;AACA;AAEA,cALA,wBAKA;AACA;AACA;AACA,gCADA;AAEA;AAAA;AAAA;AAFA;AAIA,OALA;AAMA,KAZA;AAcA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA,OAHA,CAGA;AACA;AACA;AACA;AACA;AA7CA,GAlBA;AAoEA;AACA,uBADA,iCACA;AACA;AACA;AAHA,GApEA;AA0EA;AACA,mBADA,6BACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,kBADA,GACA,KADA;;AAAA,qBAEA,yCAFA;AAAA;AAAA;AAAA;;AAGA,mBAHA,aAGA,4BAHA;AAKA,uBALA,GAKA;AACA,gCADA;AAEA,mCAFA;AAGA;AAHA,iBALA;AAAA;AAYA;AAZA;AAAA,uBAaA,wBAbA;;AAAA;AAaA,wBAbA;;AAcA;AACA;AACA;AACA,mBAHA,CAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,mDAdA,CAeA;;;AACA;AACA,iBAjBA,MAiBA,IACA,4CACA,mCAFA,EAGA;AACA;AACA;AACA;AACA,sEACA;AACA;AACA,mBAHA,EAJA,CASA;;AACA;AACA,iBAdA,MAcA,IACA,mCACA,oCAFA,EAGA;AACA;;AACA;AACA;;AAnDA;AAAA;;AAAA;AAAA;AAAA;AAqDA;;AACA;;AAtDA;AAwDA;;AAxDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0DA,KA3DA;AA6DA,YA7DA,sBA6DA;AACA;;AAEA;AACA;AACA;AACA;AAnEA,GA1EA;AAgJA,SAhJA,qBAgJA;AACA;AACA;AAlJA,G;;;;;;;;;;;;ACpFA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS,aAAa,EAAE;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,2BAA2B;AAC3B,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,gCAAgC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA,kDAAkD,oBAAoB;AACtE;AACA;AACA,qCAAqC,mCAAmC;AACxE;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,2CAA2C;AAC1E;AACA;AACA;AACA;AACA,4CAA4C;AAC5C,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,mCAAmC,4BAA4B,EAAE;AAC9E;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACvMA;AAAA;AAAA;AAAA;AAA8G;AAC3B;AACL;;;AAG9E;AACgG;AAChG,gBAAgB,2GAAU;AAC1B,EAAE,qGAAM;AACR,EAAE,0GAAM;AACR,EAAE,mHAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACtCf;AAAA;AAAA,wCAAqN,CAAgB,2QAAG,EAAC,C;;;;;;;;;;;;ACAzO;AAAA;AAAA;AAAA;AAAA;AAAA","file":"13.js","sourcesContent":["<template>\n    <v-container>\n        <!-- <v-alert\n            text\n            type=\"error\"\n            dismissible\n            transition=\"scale-transition\"\n            v-model=\"errMsgsShown\"\n        >\n            <div>\n                <p\n                    class=\"ma-0 pa-0\"\n                    v-for=\"(errMsg, index) in errMsgs\"\n                    :key=\"index\"\n                >\n                    {{ errMsg }}\n                </p>\n                <br />\n            </div>\n        </v-alert> -->\n\n        <v-form v-model=\"frm_edit_principal\" ref=\"frm_edit_principal\">\n            <v-row>\n                <v-col cols=\"12\">\n                    <v-btn @click=\"editDone\"  rounded depressed small\n                        color=\"primary\" class=\"mb-3\"\n                    >\n                        {{ editMode==false ? 'Edit Selection' : 'Done' }}\n                    </v-btn>\n                    <v-select\n                        multiple outlined clearable\n                        v-model=\"account.main_vendor_codes\"\n                        :items=\"filteredPrincipals\"\n                        item-text=\"caption\"\n                        item-value=\"main_vendor_code\"\n                        label=\"Assigned Principals\"\n                        :disabled=\"!editMode\"\n                    >\n                        <template v-slot:prepend-item>\n                            <div class=\"mx-2 mb-0 pb-0\">\n                                <v-text-field\n                                    clearable solo-inverted rounded flat\n                                    placeholder=\"Search\"\n                                    v-model=\"principalsSearchKey\"\n\n                                ></v-text-field>\n                            </div>\n                        </template>\n                        <template v-slot:item = \"{ item }\">\n                            <div class=\"py-2\">\n                                <div v-for=\"(c, index) in item.caption\" :key=\"index + '_1'\">\n                                    <small class=\"text-caption ma-1\">{{ c }}</small>\n                                    <br>\n                                </div>\n                            </div>\n                        </template>\n                        <template v-slot:selection = \"{ item }\">\n                            <div v-for=\"(c, index) in item.caption\" :key=\"index + '_' + item.main_vendor_code\">\n                                <v-chip color=\"primary\" x-small>{{ c }}</v-chip>\n                            </div>\n                        </template>\n                    </v-select>\n                </v-col>\n            </v-row>\n\n            <v-row class=\"pt-0 pb-0\" background-color=\"red\">\n                <v-col class=\"pt-0 pb-2\" background-color=\"red\">\n                    <v-btn\n                        color=\"primary\"\n                        @click=\"updatePrincipal()\"\n                        :loading=\"updatingPrincipal\"\n                        class=\"float-lg-right float-md-right float-sm-right\"\n                        rounded\n                        :disabled=\"editMode\"\n                    >\n                        Update\n                    </v-btn>\n                </v-col>\n            </v-row>\n        </v-form>\n    </v-container>\n</template>\n\n<script>\nexport default {\n    data() {\n        return {\n            frm_edit_principal: false,\n            account: {\n                id: this.ManageAccounts.state.toEdit.id,\n                user_type: this.ManageAccounts.state.toEdit.user_type,\n                main_vendor_codes: this.ManageAccounts.state.toEdit.main_vendor_codes,\n            },\n            updatingPrincipal: false,\n            errMsgs: [],\n            errMsgsShown: false,\n            errorMsgs: {},\n            principalsSearchKey: '',\n            editMode: false,\n        };\n    },\n\n    computed: {\n        // principals() {\n        //     return this.AppStore.state.principals;\n        // },\n\n        principals() {\n            return this.AppStore.state.principals.map(e => {\n                return {\n                    main_vendor_code: e[0],\n                    caption: e[1].map(el => `${el.vendor_code} - ${el.name}`),\n                }\n            });\n        },\n\n        // filteredPrincipals() {\n        //     const searchRegex = new RegExp(this.principalsSearchKey, \"i\");\n\n        //     if (JSON.parse(this.AuthUser.principal_ids)[0] === \"*\") {\n        //         return this.principals.filter(\n        //             principal => {\n        //                 return searchRegex.test(principal.name)\n        //                     || !this.principalsSearchKey\n        //                     || searchRegex.test(principal.vendor_code);\n        //             }\n\n        //         );\n        //     } else {\n        //         return this.principals.filter(\n        //             principal => {\n        //                 return (searchRegex.test(principal.name)\n        //                     || !this.principalsSearchKey\n        //                     || searchRegex.test(principal.vendor_code))\n        //                     && this.AppStore.isInUserPrincipalIDs(principal.id);\n        //             }\n        //         );\n        //     }\n        // },\n        filteredPrincipals: function() {\n            try {\n                const searchRegex = new RegExp(this.principalsSearchKey, \"i\");\n                return this.principals.filter(p => searchRegex.test(p.caption));\n            } catch (error) {\n                console.error(error);\n                return [];\n            }\n        },\n\n\n    },\n\n    watch: {\n        principalsSearchKey() {\n            if(this.principalsSearchKey==null) this.principalsSearchKey = '';\n        }\n    },\n\n    methods: {\n        async updatePrincipal() {\n            const vm = this;\n            if (this.$refs.frm_edit_principal.validate()) {\n                let url = `${this.AppStore.state.siteUrl}accounts/update-principal-assignment`;\n\n                let payload = {\n                    _method: \"PUT\",\n                    id: vm.account.id,\n                    main_vendor_codes: vm.account.main_vendor_codes,\n                }\n\n                try {\n                    this.updatingPrincipal = true;\n                    let response = await axios.post(url, payload);\n                    if (response.data == true) {\n                        if(this.$route.meta.name==='Account') {\n                            location.reload();\n                        }\n\n                        // temp\n                        // this.ManageAccounts.state.toEdit.name = vm.account.name;\n                        // this.ManageAccounts.state.toEdit.old_username =\n                        //     vm.account.username;\n                        // this.ManageAccounts.state.toEdit.username =\n                        //     vm.account.username;\n                        // this.ManageAccounts.state.toEdit.user_type =\n                        //     vm.account.user_type;\n\n                        this.ManageAccounts.initUsers();\n                        // this.ManageAccounts.state.modalEditIsOpen = false;\n                        this.AppStore.toast(\"Account updated\", 2000);\n                    } else if (\n                        response.data.invalidations != undefined ||\n                        response.data.invalidations != null\n                    ) {\n                        this.errMsgs = [];\n                        this.errorMsgs = {};\n                        this.errorMsgs = response.data.invalidations;\n                        Object.entries(response.data.invalidations).forEach(\n                            field => {\n                                this.errMsgs.push(field[1][0]);\n                            }\n                        );\n                        // this.AppStore.toast(this.errMsgs, 3000);\n                        this.errMsgsShown = true;\n                    } else if (\n                        response.data.errorInfo != null ||\n                        response.data.errorInfo != undefined\n                    ) {\n                        this.AppStore.toast(\"An error occured\", 2000);\n                        console.log(response.data.errorInfo);\n                    }\n                } catch (error) {\n                    console.log(error);\n                    this.AppStore.toast(error, 3000);\n                }\n                this.updatingPrincipal = false;\n            }\n        },\n\n        editDone() {\n            this.editMode = !this.editMode;\n\n            if(this.editMode == false) {\n                this.principalsSearchKey = '';\n            }\n        }\n    },\n\n    mounted() {\n        console.log('AccountsEditPrincipalAssignment component mounted', this.account);\n    },\n\n};\n</script>\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"v-container\",\n    [\n      _c(\n        \"v-form\",\n        {\n          ref: \"frm_edit_principal\",\n          model: {\n            value: _vm.frm_edit_principal,\n            callback: function($$v) {\n              _vm.frm_edit_principal = $$v\n            },\n            expression: \"frm_edit_principal\"\n          }\n        },\n        [\n          _c(\n            \"v-row\",\n            [\n              _c(\n                \"v-col\",\n                { attrs: { cols: \"12\" } },\n                [\n                  _c(\n                    \"v-btn\",\n                    {\n                      staticClass: \"mb-3\",\n                      attrs: {\n                        rounded: \"\",\n                        depressed: \"\",\n                        small: \"\",\n                        color: \"primary\"\n                      },\n                      on: { click: _vm.editDone }\n                    },\n                    [\n                      _vm._v(\n                        \"\\n                    \" +\n                          _vm._s(\n                            _vm.editMode == false ? \"Edit Selection\" : \"Done\"\n                          ) +\n                          \"\\n                \"\n                      )\n                    ]\n                  ),\n                  _vm._v(\" \"),\n                  _c(\"v-select\", {\n                    attrs: {\n                      multiple: \"\",\n                      outlined: \"\",\n                      clearable: \"\",\n                      items: _vm.filteredPrincipals,\n                      \"item-text\": \"caption\",\n                      \"item-value\": \"main_vendor_code\",\n                      label: \"Assigned Principals\",\n                      disabled: !_vm.editMode\n                    },\n                    scopedSlots: _vm._u([\n                      {\n                        key: \"prepend-item\",\n                        fn: function() {\n                          return [\n                            _c(\n                              \"div\",\n                              { staticClass: \"mx-2 mb-0 pb-0\" },\n                              [\n                                _c(\"v-text-field\", {\n                                  attrs: {\n                                    clearable: \"\",\n                                    \"solo-inverted\": \"\",\n                                    rounded: \"\",\n                                    flat: \"\",\n                                    placeholder: \"Search\"\n                                  },\n                                  model: {\n                                    value: _vm.principalsSearchKey,\n                                    callback: function($$v) {\n                                      _vm.principalsSearchKey = $$v\n                                    },\n                                    expression: \"principalsSearchKey\"\n                                  }\n                                })\n                              ],\n                              1\n                            )\n                          ]\n                        },\n                        proxy: true\n                      },\n                      {\n                        key: \"item\",\n                        fn: function(ref) {\n                          var item = ref.item\n                          return [\n                            _c(\n                              \"div\",\n                              { staticClass: \"py-2\" },\n                              _vm._l(item.caption, function(c, index) {\n                                return _c(\"div\", { key: index + \"_1\" }, [\n                                  _c(\n                                    \"small\",\n                                    { staticClass: \"text-caption ma-1\" },\n                                    [_vm._v(_vm._s(c))]\n                                  ),\n                                  _vm._v(\" \"),\n                                  _c(\"br\")\n                                ])\n                              }),\n                              0\n                            )\n                          ]\n                        }\n                      },\n                      {\n                        key: \"selection\",\n                        fn: function(ref) {\n                          var item = ref.item\n                          return _vm._l(item.caption, function(c, index) {\n                            return _c(\n                              \"div\",\n                              { key: index + \"_\" + item.main_vendor_code },\n                              [\n                                _c(\n                                  \"v-chip\",\n                                  {\n                                    attrs: { color: \"primary\", \"x-small\": \"\" }\n                                  },\n                                  [_vm._v(_vm._s(c))]\n                                )\n                              ],\n                              1\n                            )\n                          })\n                        }\n                      }\n                    ]),\n                    model: {\n                      value: _vm.account.main_vendor_codes,\n                      callback: function($$v) {\n                        _vm.$set(_vm.account, \"main_vendor_codes\", $$v)\n                      },\n                      expression: \"account.main_vendor_codes\"\n                    }\n                  })\n                ],\n                1\n              )\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"v-row\",\n            { staticClass: \"pt-0 pb-0\", attrs: { \"background-color\": \"red\" } },\n            [\n              _c(\n                \"v-col\",\n                {\n                  staticClass: \"pt-0 pb-2\",\n                  attrs: { \"background-color\": \"red\" }\n                },\n                [\n                  _c(\n                    \"v-btn\",\n                    {\n                      staticClass:\n                        \"float-lg-right float-md-right float-sm-right\",\n                      attrs: {\n                        color: \"primary\",\n                        loading: _vm.updatingPrincipal,\n                        rounded: \"\",\n                        disabled: _vm.editMode\n                      },\n                      on: {\n                        click: function($event) {\n                          return _vm.updatePrincipal()\n                        }\n                      }\n                    },\n                    [_vm._v(\"\\n                    Update\\n                \")]\n                  )\n                ],\n                1\n              )\n            ],\n            1\n          )\n        ],\n        1\n      )\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./AccountsEditDesignatedPrincipal.vue?vue&type=template&id=9dd72dda&\"\nimport script from \"./AccountsEditDesignatedPrincipal.vue?vue&type=script&lang=js&\"\nexport * from \"./AccountsEditDesignatedPrincipal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"C:\\\\laragon\\\\www\\\\DSGPM_DEV\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('9dd72dda')) {\n      api.createRecord('9dd72dda', component.options)\n    } else {\n      api.reload('9dd72dda', component.options)\n    }\n    module.hot.accept(\"./AccountsEditDesignatedPrincipal.vue?vue&type=template&id=9dd72dda&\", function () {\n      api.rerender('9dd72dda', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"resources/js/pages/ManageAccounts/AccountsEditDesignatedPrincipal.vue\"\nexport default component.exports","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AccountsEditDesignatedPrincipal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AccountsEditDesignatedPrincipal.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AccountsEditDesignatedPrincipal.vue?vue&type=template&id=9dd72dda&\""],"sourceRoot":""}