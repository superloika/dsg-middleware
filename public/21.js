(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{102:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n.n(s);function a(e,t,n,s,r,a,c){try{var o=e[a](c),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(s,r)}var c={data:function(){var e=this;return{nameRegex:/^[a-zA-Z\s]+$/,usernameRegex:/^[a-zA-Z0-9]+$/,frm_add:!1,newAccount:{name:"",username:"",password:"",passwordConfirm:"",user_type:"",selected_principals:[],rules:{name:[function(e){return!!e||"Name is required"},function(e){return e.length>=8||"Name must be 8 characters or above"},function(t){return e.nameRegex.test(t)||"Invalid name. Use alpha characters only"}],username:[function(e){return!!e||"Username is required"},function(e){return e.length>=5||"Username must be 5 characters or above"},function(t){return e.usernameRegex.test(t)||"Invalid username"}],password:[function(e){return!!e||"Password is required"},function(e){return e.length>=5||"Password must be 5 characters or above"}],passwordConfirm:[function(e){return!!e||"Please confirm password"},function(t){return e.newAccount.password===e.newAccount.passwordConfirm||"Password did not match"}],user_type:[function(e){return!!e||"User type is required"}]}},savingNewUser:!1,errMsgs:[],errMsgsShown:!1}},watch:{"newAccount.name":function(){this.newAccount.name=this.newAccount.name.replace("  "," ").trim()},"newAccount.user_type":function(){"super_admin"===this.newAccount.user_type?this.newAccount.selected_principals=["*"]:this.newAccount.selected_principals=[]}},methods:{saveNewUser:function(){var e,t=this;return(e=r.a.mark((function e(){var n,s,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,!t.$refs.frm_add.validate()){e.next=16;break}return s="".concat(t.AppStore.state.siteUrl,"accounts"),e.prev=3,t.savingNewUser=!0,e.next=7,axios.post(s,{name:n.newAccount.name,username:n.newAccount.username,password:n.newAccount.password,user_type:n.newAccount.user_type,selected_principals:n.newAccount.selected_principals});case 7:1==(a=e.sent).data?(t.ManageAccounts.initUsers(),t.ManageAccounts.state.modalAddIsOpen=!1,t.AppStore.toast("New account added",2e3)):null!=a.data.invalidations||null!=a.data.invalidations?(t.errMsgs=[],Object.entries(a.data.invalidations).forEach((function(e){t.errMsgs.push(e[1][0])})),t.errMsgsShown=!0):null==a.data.errorInfo&&null==a.data.errorInfo||(t.AppStore.toast("An error occured",2e3),console.log(a.data.errorInfo)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0),t.AppStore.toast(e.t0,3e3);case 15:t.savingNewUser=!1;case 16:case"end":return e.stop()}}),e,null,[[3,11]])})),function(){var t=this,n=arguments;return new Promise((function(s,r){var c=e.apply(t,n);function o(e){a(c,s,r,o,u,"next",e)}function u(e){a(c,s,r,o,u,"throw",e)}o(void 0)}))})()}},computed:{},created:function(){},mounted:function(){console.log("ExpendituresAdd mounted.")}},o=n(0),u=Object(o.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-card-title",[n("v-icon",[e._v("mdi-account-plus")]),e._v(" "),n("span",{staticClass:"ml-2"},[e._v("Add Account")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){e.ManageAccounts.state.modalAddIsOpen=!1}}},[n("v-icon",[e._v("mdi-close-box-outline")])],1)],1),e._v(" "),n("v-card-text",[n("v-alert",{attrs:{dense:"",text:"",type:"error",dismissible:"",transition:"scale-transition"},model:{value:e.errMsgsShown,callback:function(t){e.errMsgsShown=t},expression:"errMsgsShown"}},e._l(e.errMsgs,(function(t,s){return n("p",{key:s,staticClass:"ma-0 pa-0"},[e._v("\n                "+e._s(t)+"\n            ")])})),0),e._v(" "),n("br"),e._v(" "),n("v-form",{ref:"frm_add",model:{value:e.frm_add,callback:function(t){e.frm_add=t},expression:"frm_add"}},[n("v-row",{staticClass:"pa-0"},[n("v-col",{staticClass:"pt-1 pb-1",attrs:{cols:"12",md:"4",sm:"6"}},[n("v-text-field",{attrs:{outlined:"",dense:"",text:"",label:"Name *",required:"",rules:e.newAccount.rules.name},model:{value:e.newAccount.name,callback:function(t){e.$set(e.newAccount,"name",t)},expression:"newAccount.name"}})],1),e._v(" "),n("v-col",{staticClass:"pt-1 pb-1",attrs:{cols:"12",md:"4",sm:"6"}},[n("v-text-field",{attrs:{outlined:"",dense:"",text:"",label:"Username *",required:"",rules:e.newAccount.rules.username},model:{value:e.newAccount.username,callback:function(t){e.$set(e.newAccount,"username",t)},expression:"newAccount.username"}})],1),e._v(" "),n("v-col",{staticClass:"pt-1 pb-1",attrs:{cols:"12",md:"4",sm:"6"}},[n("v-select",{attrs:{items:e.AppStore.state.userTypes,outlined:"",dense:"",text:"",label:"User Type *",required:"",rules:e.newAccount.rules.user_type},model:{value:e.newAccount.user_type,callback:function(t){e.$set(e.newAccount,"user_type",t)},expression:"newAccount.user_type"}})],1),e._v(" "),n("v-col",{staticClass:"pt-1 pb-1",attrs:{cols:"12",md:"4",sm:"6"}},[n("v-text-field",{attrs:{outlined:"",dense:"",text:"",label:"Password *",autocomplete:"false",required:"",type:"password",rules:e.newAccount.rules.password},model:{value:e.newAccount.password,callback:function(t){e.$set(e.newAccount,"password",t)},expression:"newAccount.password"}})],1),e._v(" "),n("v-col",{staticClass:"pt-1 pb-1",attrs:{cols:"12",md:"4",sm:"6"}},[n("v-text-field",{attrs:{outlined:"",dense:"",text:"",label:"Confirm Password *",autocomplete:"false",required:"",type:"password",rules:e.newAccount.rules.passwordConfirm},model:{value:e.newAccount.passwordConfirm,callback:function(t){e.$set(e.newAccount,"passwordConfirm",t)},expression:"newAccount.passwordConfirm"}})],1),e._v(" "),"user"===e.newAccount.user_type?n("v-col",{staticClass:"pt-1 pb-1",attrs:{cols:"12",md:"4",sm:"6"}},[n("v-select",{attrs:{items:e.AppStore.state.principals,"item-text":"name","item-value":"id",label:"Designated Principals",multiple:"",dense:"",outlined:""},model:{value:e.newAccount.selected_principals,callback:function(t){e.$set(e.newAccount,"selected_principals",t)},expression:"newAccount.selected_principals"}})],1):e._e()],1),e._v(" "),n("v-row",{staticClass:"pa-0"},[n("v-col",[n("div",{staticClass:"float-right"},[n("v-btn",{attrs:{color:"primary",dense:"",smallx:"",outlinedx:"",loading:e.savingNewUser,roundedx:""},on:{click:function(t){return e.saveNewUser()}}},[e._v("\n                            Save\n                        ")])],1)])],1)],1)],1)],1)}),[],!1,null,null,null);t.default=u.exports}}]);